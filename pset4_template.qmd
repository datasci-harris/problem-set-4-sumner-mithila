---
title: "Your Title"
format: 
  pdf:
    keep-tex: true
    include-in-header: 
       text: |
         \usepackage{fvextra}
         \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
include-before-body:
  text: |
    \RecustomVerbatimEnvironment{verbatim}{Verbatim}{
      showspaces = false,
      showtabs = false,
      breaksymbolleft={},
      breaklines
    }
---

**PS4:** Due Sat Nov 2 at 5:00PM Central. Worth 100 points. 

## Style Points (10 pts)

## Submission Steps (10 pts)

Partner 1: Sumner Perera (CNet ID: 12403312)
Partner 2: Mithila Iyer (CNet ID: 12414493)

“This submission is our work alone and complies with the 30538 integrity policy.” Add
your initials to indicate your agreement: **SP** **__**

“I have uploaded the names of anyone else other than my partner and I worked with
on the problem set here” (1 point)

Late coins used this pset: **__** Late coins left after submission: **__**

## Download and explore the Provider of Services (POS) file (10 pts)

Provider type code 01 (PRVDR_CTGRY_CD) and subtype code 01 (PRVDR_CTGRY_SBTYP_CD)
CMS Certification Number: PRVDR_NUM
Closed if its Termination Code in the POS file lists them as an “Active Provider” in 2016
- PGM_TRMNTN_CD and the value for "Active Provider" is 00
Zip code: ZIP_CD
Name of provider: FAC_NAME 
Year of suspected closure: FY_END_MO_DAY_CD 

Link to filtered view: https://data.cms.gov/provider-characteristics/hospitals-and-other-facilities/provider-of-services-file-hospital-non-hospital-facilities/data/q4-2016?query=%7B%22filters%22%3A%7B%22rootConjunction%22%3A%7B%22label%22%3A%22And%22%2C%22value%22%3A%22AND%22%7D%2C%22list%22%3A%5B%5D%7D%2C%22keywords%22%3A%22%22%2C%22offset%22%3A0%2C%22limit%22%3A10%2C%22sort%22%3A%7B%22sortBy%22%3Anull%2C%22sortOrder%22%3Anull%7D%2C%22columns%22%3A%5B%22PRVDR_CTGRY_SBTYP_CD%22%2C%22PRVDR_CTGRY_CD%22%2C%22FAC_NAME%22%2C%22PRVDR_NUM%22%2C%22PGM_TRMNTN_CD%22%2C%22ZIP_CD%22%2C%22FY_END_MO_DAY_CD%22%5D%7D 


1. After reviewing the entirety of the pset and the questions that are asked, I pulled the following variables: 

- PRVDR_CTGRY_CD: Provider type 
- PRVDR_CTGRY_SBTYP_CD: Subtype code 
- PRVDR_NUM: CMS Certification Number
- PGM_TRMNTN_CD: Provider termination code 
- ZIP_CD: Zip code 
- FAC_NAME: Provider name 
- FY_END_MO_DAY_CD: Year of suspected closure 

2. 
```{python}
# Import the file from my local drive 
import pandas as pd 
import os 
base_path = r"C:\Users\12019\\Downloads\pos2016"
path = os.path.join(base_path, "pos2016.csv")
pos2016 = pd.read_csv(path)

# Subset to PRVDR_CTGRY_CD = 01 and PRVDR_CTGRY_SBTYP_CD = 01 
subset_16 = pos2016[(pos2016["PRVDR_CTGRY_SBTYP_CD"] == 1) & (pos2016["PRVDR_CTGRY_CD"] == 1)]

# Count the number of rows 
total_16 = len(subset_16)
total_16
```

Subsetting to short-term hospitals gives a dataset with 7245 total facilities. According to the linked paper, there are nearly 5,000 short-term acute care hospitals which is a smaller subset than what I found with subsetting. Another data source (https://www.aha.org/statistics/fast-facts-us-hospitals) cites a total of 6,120 hospitals in the US. Both sources cite a lower number than what we found which suggests that this number may be inaccurate. It could differ because there are hospitals listed which have actually closed or not operational. 
    
3.
```{python}
# Load in datasets 
base_path1 = r"C:\Users\12019\\Downloads\pos2017"
path1 = os.path.join(base_path1, "pos2017.csv")
pos2017 = pd.read_csv(path1)

base_path2 = r"C:\Users\12019\\Downloads\pos2018"
path2 = os.path.join(base_path2, "pos2018.csv")
pos2018 = pd.read_csv(path2, encoding='latin1')

# Note: Had to do the encoding='latin1' addition to account for errors which said: 
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 11970: invalid start byte

base_path3 = r"C:\Users\12019\\Downloads\pos2019"
path3 = os.path.join(base_path3, "pos2019.csv")
pos2019 = pd.read_csv(path3, encoding='latin1')

# Drawn from ChatGPT. Asked "How do you append multiple data sets with the same columns?"
combined = pd.concat([pos2016, pos2017, pos2018, pos2019], axis=0)

# Plot the number of observations by year  
import altair as alt
alt.Chart(combined).mark_bar().encode(
  alt.X('year:Q'), 
  y='count()'
)

```



4. 
    a.
    b.

## Identify hospital closures in POS file (15 pts) (*)

1. 
2. 
3. 
    a.
    b.
    c.

## Download Census zip code shapefile (10 pt) 

1. 
    a.
    b. 
2. 

## Calculate zip code’s distance to the nearest hospital (20 pts) (*)

1. 
2. 
3. 
4. 
    a.
    b.
    c.
5. 
    a.
    b.
    c.
    
## Effects of closures on access in Texas (15 pts)

1. 
2. 
3. 
4. 

## Reflecting on the exercise (10 pts) 
